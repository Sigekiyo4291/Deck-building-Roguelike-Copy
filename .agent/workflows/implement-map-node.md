---
description: マップ上の新しいノード（例：イベント、ボス、エリート）の機能と専用画面を実装する手順
---

# マップノード実装ワークフロー

マップ上に新しい種類のノードを追加する際は、以下のステップを順に実行してください。

1. **HTML構造の追加**
   `index.html` に新しいシーン用のコンテナ（例: `#event-scene`）を追加します。既存のシーン（`#shop-scene` など）の直後に配置することを推奨します。

2. **スタイルの定義**
   `style.css` に新しいシーン用のスタイルを追加します。
   - `SceneManager.hideAllScenes` が正しく機能するように、新しいコンテナには必ず `.scene` クラスを付与してください。
   - レイアウトは `.shop-container` や `.rest-container` 等と整合性を取ってください。

3. **SceneManagerの拡張**
   `src/core/scene-manager.js` に `showXxx()` メソッドを追加します。
   - メソッドの冒頭で必ず `this.hideAllScenes()` を呼び出してください。
   - `hideAllScenes` メソッド内の強制非表示リストに、新しい要素を追加してください。

4. **ゲームロジックの実装**
   `src/main.js` の `Game` クラスを更新します。
   - `onNodeSelect` メソッドを拡張し、新しいノードタイプが選択された際に初期化メソッド（例: `showEventScene()`）を呼び出すようにします。
   - `showXxxScene()` メソッド内で、UIの更新、ボタンイベントの設定、結果の処理を実装します。

5. **検証**
   - マップからノードを選択して正しく遷移するか確認します。
   - 遷移後に前の画面（マップ等）が完全に消えているか確認します。
   - 処理完了後に `this.renderMap()` を呼んでマップに戻れるか確認します。
