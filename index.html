<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="vite.svg" />
  <link rel="stylesheet" href="src/style.css">
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <title>Card Crawler Web</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,700;1,400&display=swap"
    rel="stylesheet">
</head>

<body>
  <!-- 縦向き警告オーバーレイ（モバイル専用） -->
  <div class="orientation-warning">
    <div class="orientation-warning-icon">📱</div>
    <div class="orientation-warning-text">横向きでプレイすることを推奨します</div>
    <div class="orientation-warning-subtext">デバイスを回転させてください</div>
  </div>

  <div id="app">
    <div id="global-header" class="global-header">
      <div class="header-left">
        <span id="header-player-name" class="header-item player-name">Ironclad</span>
        <div class="header-item stat-hp">
          <span class="stat-icon">❤️</span>
          <span id="header-hp-text">50/50</span>
        </div>
        <div class="header-item stat-gold">
          <span class="stat-icon">💰</span>
          <span id="header-gold-text">0</span>
        </div>
        <div id="potion-container" class="potion-container"></div>
      </div>

      <div class="header-right">
        <div class="header-item stat-floor">
          <span class="stat-icon">🪜</span>
          <span id="header-floor-text">1</span>
        </div>
        <div class="header-buttons">
          <button id="header-deck-btn" class="header-btn" title="デッキ閲覧">🎴</button>
          <button id="header-settings-btn" class="header-btn" title="設定">⚙️</button>
        </div>
      </div>
    </div>
    <div id="relic-container" class="relic-container"></div>
    <div id="title-scene" class="scene active" style="display: flex;">
      <h1 class="game-title">StS Copy</h1>
      <button id="game-start-btn" class="end-turn-btn large-btn">Game Start</button>
    </div>

    <div class="battle-scene" style="display: none;">
      <!-- プレイヤー -->
      <div id="player" class="entity">
        <div class="intent-icon" style="display: none;"></div>
        <img src="assets/player.png" alt="Player" class="entity-sprite" />
        <div class="entity-info">
          <div class="hp-bar-container">
            <div id="player-hp-fill" class="hp-bar-fill" style="width: 100%;"></div>
            <div id="player-block" class="block-overlay" style="width: 0%;"></div>
          </div>
          <div class="status-text">
            <span id="player-hp-text">50 / 50</span>
            <span id="player-block-text" class="block-text" style="display: none;">🛡️0</span>
          </div>
          <div id="player-status-container" class="status-container"></div>
        </div>
      </div>

      <!-- 敵 -->
      <!-- 敵エリア -->
      <div id="enemies-container" class="enemies-container">
        <!-- JSでここに敵エンティティを追加 -->
      </div>
    </div>

    <div id="map-scene" class="scene" style="display: none;">
      <div id="map-container" class="map-container">
        <!-- マップノードがここに生成されます -->
      </div>
    </div>

    <!-- ... (中略) ... -->

    <!-- デッキ閲覧オーバーレイ -->
    <div id="deck-view-overlay" class="overlay" style="display: none;">
      <div class="card-reward-container large">
        <h2 class="scene-title" style="margin-bottom: 20px;">現在のデッキ</h2>
        <div id="deck-view-content" class="card-choices scrollable">
          <!-- カード一覧 -->
        </div>
        <button id="close-deck-btn" class="end-turn-btn" style="margin-top: 20px;">閉じる</button>
      </div>
    </div>

    <div id="reward-scene" class="scene" style="display: none;">
      <h2 class="scene-title">勝利！</h2>
      <div id="reward-list" class="reward-list">
        <!-- 報酬アイテムがここに生成されます -->
      </div>
      <button id="reward-done-btn" class="end-turn-btn" style="margin-top: 20px;">次へ</button>
    </div>

    <div id="treasure-scene" class="scene" style="display: none;">
      <h2 class="scene-title">宝箱を見つけた！</h2>
      <div class="treasure-container">
        <div id="treasure-icon" style="font-size: 100px; margin-bottom: 30px; cursor: pointer;">🎁</div>
        <button id="open-treasure-btn" class="end-turn-btn">開ける</button>
      </div>
    </div>

    <div id="shop-scene" class="scene" style="display: none;">
      <div class="shop-container">
        <!-- 上段: カード 5種類 -->
        <div class="shop-row-top">
          <div id="shop-cards-top" class="shop-item-list"></div>
        </div>

        <!-- 下段: 共通カード、レリック、ポーション、カード削除 -->
        <div class="shop-row-bottom">
          <button id="shop-leave-btn" class="leave-banner-btn">立ち去る</button>

          <!-- 左下: 共通クラスカード 2種類 -->
          <div class="shop-bottom-left">
            <div id="shop-cards-bottom-left" class="shop-item-list"></div>
          </div>

          <!-- 中央下: レリック 3つ & ポーション 3つ -->
          <div class="shop-bottom-center">
            <div id="shop-relics-center" class="shop-item-list relic-potion-grid"></div>
            <div id="shop-potions-center" class="shop-item-list relic-potion-grid"></div>
          </div>

          <!-- 右下: カード削除 -->
          <div class="shop-bottom-right">
            <div id="shop-removal-service" class="shop-item-list"></div>
          </div>
        </div>


      </div>
    </div>

    <div id="rest-scene" class="scene" style="display: none;">
      <h2 class="scene-title">休憩所</h2>
      <div class="rest-container">
        <div class="rest-image" style="font-size: 80px; margin-bottom: 20px;">🔥</div>
        <div class="rest-options">
          <button id="rest-heal-btn" class="end-turn-btn rest-option-btn">
            <span class="option-icon">💤</span>
            <span class="option-label">休む</span>
            <span class="option-desc">HPを30%回復</span>
          </button>
          <button id="rest-upgrade-btn" class="end-turn-btn rest-option-btn">
            <span class="option-icon">🔨</span>
            <span class="option-label">鍛える</span>
            <span class="option-desc">カード1枚を強化</span>
          </button>
        </div>
      </div>
    </div>

    <div id="deck-selection-overlay" class="overlay" style="display: none;">
      <div class="card-reward-container large">
        <h2 id="deck-selection-title">カードを選択</h2>
        <div id="deck-selection-list" class="card-choices scrollable">
          <!-- デッキのカード一覧 -->
        </div>
        <button id="close-deck-selection-btn" class="end-turn-btn" style="margin-top: 20px;">閉じる</button>
      </div>
    </div>

    <div id="event-scene" class="scene" style="display: none;">
      <h2 class="scene-title">イベント</h2>
      <div class="event-container">
        <div id="event-content" class="event-content">
          <div id="event-image" class="event-image">❓</div>
          <div class="event-text-area">
            <h3 id="event-name">未知との遭遇</h3>
            <p id="event-description">道中に不思議な何かを見つけた...</p>
          </div>
        </div>
        <div id="event-options" class="event-options-vertical">
          <!-- 選択肢ボタンがここに生成されます -->
        </div>
      </div>
    </div>

    <div id="card-reward-overlay" class="overlay" style="display: none;">
      <div class="card-reward-container">
        <h2>カードを選択</h2>
        <div id="card-choices" class="card-choices">
          <!-- カード候補 -->
        </div>
        <button id="skip-card-btn" class="end-turn-btn" style="margin-top: 20px;">スキップ</button>
      </div>
    </div>

    <div id="boss-relic-overlay" class="overlay" style="display: none;">
      <div class="card-reward-container">
        <h2>ボスレリックを選択</h2>
        <div id="boss-relic-choices" class="card-choices">
          <!-- レリック候補 -->
        </div>
      </div>
    </div>

    <div class="ui-layer" style="display: none;">
      <div class="deck-info">
        <div id="deck-pile" class="deck-pile">
          <span class="pile-label">山札</span>
          <span id="deck-count" class="pile-count">10</span>
        </div>
        <div class="energy-display">エネルギー: <span id="energy-value">3</span> / 3</div>
        <div id="discard-pile" class="discard-pile">
          <span class="pile-label">捨て札</span>
          <span id="discard-count" class="pile-count">0</span>
        </div>
        <div id="exhaust-pile" class="exhaust-pile">
          <span class="pile-label">廃棄</span>
          <span id="exhaust-count" class="pile-count">0</span>
        </div>
      </div>
      <div class="hand-and-button-container">
        <div id="hand" class="hand">
          <!-- カードがここに動的に生成される -->
        </div>
        <button id="end-turn-btn" class="end-turn-btn">Turn End</button>
      </div>
    </div>
  </div>

  <!-- 設定オーバーレイ -->
  <div id="settings-overlay" class="overlay" style="display: none;">
    <div class="card-reward-container large settings-modal">
      <h2 class="scene-title" style="margin-bottom: 20px;">設定</h2>

      <div class="settings-group">
        <label class="settings-label">BGM</label>
        <div class="settings-control">
          <input type="checkbox" id="bgm-mute-check">
          <label for="bgm-mute-check">OFF</label>
          <input type="range" id="bgm-volume-slider" min="0" max="1" step="0.05" value="0.2">
        </div>
      </div>

      <div class="settings-group">
        <label class="settings-label">SE</label>
        <div class="settings-control">
          <input type="checkbox" id="se-mute-check">
          <label for="se-mute-check">OFF</label>
          <input type="range" id="se-volume-slider" min="0" max="1" step="0.05" value="0.4">
        </div>
      </div>

      <button id="close-settings-btn" class="end-turn-btn" style="margin-top: 30px;">閉じる</button>
    </div>
  </div>

  <!-- ツールチップ等 -->
  <div id="tooltip" class="tooltip"></div>
  <script type="module" src="src/main.ts"></script>
</body>

</html>